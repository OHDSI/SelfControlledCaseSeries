<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running multiple analyses at once using the SelfControlledCaseSeries package • SelfControlledCaseSeries</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running multiple analyses at once using the SelfControlledCaseSeries package">
<meta property="og:description" content="SelfControlledCaseSeries">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SelfControlledCaseSeries</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MultipleAnalyses.html">Running multiple analyses at once using the SelfControlledCaseSeries package</a>
    </li>
    <li>
      <a href="../articles/SingleStudies.html">Single studies using the SelfControlledCaseSeries package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/SelfControlledCaseSeries/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MultipleAnalyses_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running multiple analyses at once using the SelfControlledCaseSeries package</h1>
                        <h4 class="author">Martijn J. Schuemie</h4>
            
            <h4 class="date">2021-07-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/SelfControlledCaseSeries/blob/master/vignettes/MultipleAnalyses.Rmd"><code>vignettes/MultipleAnalyses.Rmd</code></a></small>
      <div class="hidden name"><code>MultipleAnalyses.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this vignette we focus on running several different analyses on several exposure-outcome pairs This can be useful when we want to explore the sensitivity to analyses choices, include controls, or run an experiment similar to the OMOP experiment to empirically identify the optimal analysis choices for a particular research question.</p>
<p>This vignette assumes you are already familiar with the <code>SelfControlledCaseSeries</code> package and are able to perform single studies. We will walk through all the steps needed to perform an exemplar set of analyses, and we have selected the well-studied topic of the effect of nonsteroidal anti-inflammatory drugs (NSAIDs) on gastrointestinal (GI) bleeding-related hospitalization. For simplicity, we focus on one NSAID: diclofenac. We will execute various variations of an analysis for the primary exposure pair and a large set of negative control exposures.</p>
</div>
<div id="general-approach" class="section level1">
<h1 class="hasAnchor">
<a href="#general-approach" class="anchor"></a>General approach</h1>
<p>The general approach to running a set of analyses is that you specify all the function arguments of the functions you would normally call, and create sets of these function arguments. The final outcome models as well as intermediate data objects will all be saved to disk for later extraction.</p>
<p>An analysis will be executed by calling these functions in sequence:</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/getDbSccsData.html">getDbSccsData()</a></code></li>
<li><code><a href="../reference/createStudyPopulation.html">createStudyPopulation()</a></code></li>
<li><code><a href="../reference/createSccsIntervalData.html">createSccsIntervalData()</a></code></li>
<li><code><a href="../reference/fitSccsModel.html">fitSccsModel()</a></code></li>
</ol>
<p>When you provide several analyses to the <code>SelfControlledCaseSeries</code> package, it will determine whether any of the analyses and exposure-outcome pairs have anything in common, and will take advantage of this fact. For example, if we specify several exposure-outcome pairs with the same outcome, the data for the outcome will be extracted only once.</p>
<p>The function arguments you need to define have been divided into four groups:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Hypothesis of interest</strong>: arguments that are specific to a hypothesis of interest, in the case of the self-controlled case series this is a combination of exposure and outcome.</li>
<li>
<strong>Analyses</strong>: arguments that are not directly specific to a hypothesis of interest, such as the washout window, whether to adjust for age and seasonality, etc.</li>
<li>Arguments that are the output of a previous function in the <code>SelfControlledCaseSeries</code> package, such as the <code>SccsIntervalData</code> argument of the <code>createSccsIntervalData</code> function. These cannot be specified by the user.</li>
<li>Arguments that are specific to an environment, such as the connection details for connecting to the server, and the name of the schema holding the CDM data.</li>
</ol>
</div>
<div id="preparation-for-the-example" class="section level1">
<h1 class="hasAnchor">
<a href="#preparation-for-the-example" class="anchor"></a>Preparation for the example</h1>
<p>We need to tell R how to connect to the server where the data are. <code>SelfControlledCaseSeries</code> uses the <code>DatabaseConnector</code> package, which provides the <code>createConnectionDetails</code> function. Type <code>?createConnectionDetails</code> for the specific settings required for the various database management systems (DBMS). For example, one might connect to a PostgreSQL database using this code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">connectionDetails</span> <span class="op">&lt;-</span> <span class="fu">createConnectionDetails</span><span class="op">(</span>dbms <span class="op">=</span> <span class="st">"postgresql"</span>, 
                                             server <span class="op">=</span> <span class="st">"localhost/ohdsi"</span>, 
                                             user <span class="op">=</span> <span class="st">"joe"</span>, 
                                             password <span class="op">=</span> <span class="st">"supersecret"</span><span class="op">)</span>

<span class="va">outputFolder</span> <span class="op">&lt;-</span> <span class="st">"s:/temp/sccsVignette2"</span>

<span class="va">cdmDatabaseSchema</span> <span class="op">&lt;-</span> <span class="st">"my_cdm_data"</span>
<span class="va">cohortDatabaseSchema</span> <span class="op">&lt;-</span> <span class="st">"my_cohorts"</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>sqlRenderTempEmulationSchema <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="va">cdmVersion</span> <span class="op">&lt;-</span> <span class="st">"5"</span></code></pre></div>
<p>The last three lines define the <code>cdmDatabaseSchema</code> and <code>cohortDatabaseSchema</code> variables, as well as the CDM version. We’ll use these later to tell R where the data in CDM format live, where we want to store the (outcome) cohorts, and what version CDM is used. Note that for Microsoft SQL Server, databaseschemas need to specify both the database and the schema, so for example <code>cdmDatabaseSchema &lt;- "my_cdm_data.dbo"</code>.</p>
<p>We also need to prepare our exposures and outcomes of interest. The drug_era table in the OMOP Common Data Model already contains prespecified cohorts of users at the ingredient level, so we will use that for the exposures. For the outcomes, we want to restrict our analysis only to those events that are recorded in an inpatient setting, so we will need to create a custom cohort table. For this example, we are only interested in GI bleed (concept ID 192671) .</p>
<p>We create a text file called <em>vignette.sql</em> with the following content:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">/***********************************</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">File vignette.sql </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">***********************************/</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">IF</span> OBJECT_ID(<span class="st">'@cohortDatabaseSchema.@outcomeTable'</span>, <span class="st">'U'</span>) <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">DROP</span> <span class="kw">TABLE</span> @cohortDatabaseSchema.@outcomeTable;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dv">1</span> <span class="kw">AS</span> cohort_definition_id,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    condition_start_date <span class="kw">AS</span> cohort_start_date,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    condition_end_date <span class="kw">AS</span> cohort_end_date,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    condition_occurrence.person_id <span class="kw">AS</span> subject_id</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span> @cohortDatabaseSchema.@outcomeTable</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> @cdmDatabaseSchema.condition_occurrence</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> @cdmDatabaseSchema.visit_occurrence</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> condition_occurrence.visit_occurrence_id <span class="op">=</span> visit_occurrence.visit_occurrence_id</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> condition_concept_id <span class="kw">IN</span> (</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> descendant_concept_id</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> @cdmDatabaseSchema.concept_ancestor</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> ancestor_concept_id <span class="op">=</span> <span class="dv">192671</span> <span class="co">-- GI - Gastrointestinal haemorrhage</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> visit_occurrence.visit_concept_id <span class="kw">IN</span> (<span class="dv">9201</span>, <span class="dv">9203</span>);</span></code></pre></div>
<p>Note for CDM V4 <code>visit_concept_id</code> should be <code>place_of_service_concept_id</code>, and <code>cohort_definition_id</code> should be <code>cohort_concept_id</code>.</p>
<p>This is parameterized SQL which can be used by the <code>SqlRender</code> package. We use parameterized SQL so we do not have to pre-specify the names of the CDM and result schemas. That way, if we want to run the SQL on a different schema, we only need to change the parameter values; we do not have to change the SQL code. By also making use of translation functionality in <code>SqlRender</code>, we can make sure the SQL code can be run in many different environments.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/SqlRender/">SqlRender</a></span><span class="op">)</span>
<span class="va">sql</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SqlRender/man/readSql.html">readSql</a></span><span class="op">(</span><span class="st">"vignette.sql"</span><span class="op">)</span>
<span class="va">sql</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SqlRender/man/render.html">render</a></span><span class="op">(</span><span class="va">sql</span>,
              cdmDatabaseSchema <span class="op">=</span> <span class="va">cdmDatabaseSchema</span>, 
              cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span><span class="op">)</span>
<span class="va">sql</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SqlRender/man/translate.html">translate</a></span><span class="op">(</span><span class="va">sql</span>, targetDialect <span class="op">=</span> <span class="va">connectionDetails</span><span class="op">$</span><span class="va">dbms</span><span class="op">)</span>

<span class="va">connection</span> <span class="op">&lt;-</span> <span class="fu">connect</span><span class="op">(</span><span class="va">connectionDetails</span><span class="op">)</span>
<span class="fu">executeSql</span><span class="op">(</span><span class="va">connection</span>, <span class="va">sql</span><span class="op">)</span></code></pre></div>
<p>In this code, we first read the SQL from the file into memory. In the next line, we replace the two parameter names with the actual values. We then translate the SQL into the dialect appropriate for the DBMS we already specified in the <code>connectionDetails</code>. Next, we connect to the server, and submit the rendered and translated SQL.</p>
</div>
<div id="specifying-hypotheses-of-interest" class="section level1">
<h1 class="hasAnchor">
<a href="#specifying-hypotheses-of-interest" class="anchor"></a>Specifying hypotheses of interest</h1>
<p>The first group of arguments define the exposure and outcome. Here we demonstrate how to create a list of exposure-outcome pairs:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">negativeControls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">705178</span>, <span class="fl">705944</span>, <span class="fl">710650</span>, <span class="fl">714785</span>, <span class="fl">719174</span>, <span class="fl">719311</span>, <span class="fl">735340</span>, <span class="fl">742185</span>, 
                      <span class="fl">780369</span>, <span class="fl">781182</span>, <span class="fl">924724</span>, <span class="fl">990760</span>, <span class="fl">1110942</span>, <span class="fl">1111706</span>, <span class="fl">1136601</span>, 
                      <span class="fl">1317967</span>, <span class="fl">1501309</span>, <span class="fl">1505346</span>, <span class="fl">1551673</span>, <span class="fl">1560278</span>, <span class="fl">1584910</span>, <span class="fl">19010309</span>, 
                      <span class="fl">40163731</span><span class="op">)</span>
<span class="va">diclofenac</span> <span class="op">&lt;-</span> <span class="fl">1124300</span>
<span class="va">ppis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">911735</span>, <span class="fl">929887</span>, <span class="fl">923645</span>, <span class="fl">904453</span>, <span class="fl">948078</span>, <span class="fl">19039926</span><span class="op">)</span>

<span class="va">exposureOutcomeList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">exposureId</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">diclofenac</span>, <span class="va">negativeControls</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">exposureOutcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createExposureOutcome.html">createExposureOutcome</a></span><span class="op">(</span>exposureId <span class="op">=</span> <span class="va">exposureId</span>,
                                           outcomeId <span class="op">=</span> <span class="fl">1</span>,
                                           prophylactics <span class="op">=</span> <span class="va">ppis</span><span class="op">)</span>
  <span class="va">exposureOutcomeList</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">exposureOutcomeList</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">exposureOutcome</span>
<span class="op">}</span></code></pre></div>
<p>We defined the outcome of interest to be the custom cohort with ID 1 we defined in the SQL above. The exposures include diclofenac (concept ID 1124300) and a large number of negative control exposures. We furthermore specify a custom variable <code>prophylactics</code> that contains the concept IDs of drugs that are used in preventing the outcome of interest, in this case proton pump inhibitors (PPIs).</p>
<p>A convenient way to save <code>exposureOutcomeList</code> to file is by using the <code>saveExposureOutcomeList</code> function, and we can load it again using the <code>loadExposureOutcomeList</code> function.</p>
</div>
<div id="specifying-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#specifying-analyses" class="anchor"></a>Specifying analyses</h1>
<p>The second group of arguments are not specific to a hypothesis of interest, and comprise the majority of arguments. For each function that will be called during the execution of the analyses, a companion function is available that has (almost) the same arguments. For example, for the <code><a href="../reference/fitSccsModel.html">fitSccsModel()</a></code> function there is the <code><a href="../reference/createFitSccsModelArgs.html">createFitSccsModelArgs()</a></code> function. These companion functions can be used to create the arguments to be used during execution:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">getDbSccsDataArgs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createGetDbSccsDataArgs.html">createGetDbSccsDataArgs</a></span><span class="op">(</span>
  useCustomCovariates <span class="op">=</span> <span class="cn">FALSE</span>,
  deleteCovariatesSmallCount <span class="op">=</span> <span class="fl">100</span>,
  studyStartDate <span class="op">=</span> <span class="st">""</span>,
  studyEndDate <span class="op">=</span> <span class="st">""</span>,
  exposureIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>,
  maxCasesPerOutcome <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="va">createStudyPopulationArgs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCreateStudyPopulationArgs.html">createCreateStudyPopulationArgs</a></span><span class="op">(</span>
  naivePeriod <span class="op">=</span> <span class="fl">180</span>,
  firstOutcomeOnly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">covarExposureOfInt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEraCovariateSettings.html">createEraCovariateSettings</a></span><span class="op">(</span>
  label <span class="op">=</span> <span class="st">"Exposure of interest"</span>,
  includeEraIds <span class="op">=</span> <span class="st">"exposureId"</span>,
  start <span class="op">=</span> <span class="fl">1</span>,
  end <span class="op">=</span> <span class="fl">0</span>,
  endAnchor <span class="op">=</span> <span class="st">"era end"</span><span class="op">)</span>

<span class="va">createSccsIntervalDataArgs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCreateSccsIntervalDataArgs.html">createCreateSccsIntervalDataArgs</a></span><span class="op">(</span>
  eraCovariateSettings <span class="op">=</span> <span class="va">covarExposureOfInt</span><span class="op">)</span>

<span class="va">fitSccsModelArgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFitSccsModelArgs.html">createFitSccsModelArgs</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Any argument that is not explicitly specified by the user will assume the default value specified in the function. Note that for several arguments for concept or cohort definition IDs we can use the name of a variable in the <code>exposureOutcome</code> objects. In this case, we defined the argument <code>includeEraIds</code> to get the value of the <code>exposureId</code> variable.</p>
<p>We can now combine the arguments for the various functions into a single analysis:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sccsAnalysis1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSccsAnalysis.html">createSccsAnalysis</a></span><span class="op">(</span>analysisId <span class="op">=</span> <span class="fl">1</span>,
                                    description <span class="op">=</span> <span class="st">"Simplest model"</span>,
                                    getDbSccsDataArgs <span class="op">=</span> <span class="va">getDbSccsDataArgs1</span>,
                                    createStudyPopulationArgs <span class="op">=</span> <span class="va">createStudyPopulationArgs1</span>,
                                    createSccsIntervalDataArgs <span class="op">=</span> <span class="va">createSccsIntervalDataArgs1</span>,
                                    fitSccsModelArgs <span class="op">=</span> <span class="va">fitSccsModelArgs</span><span class="op">)</span></code></pre></div>
<p>Note that we have assigned an analysis ID (1) to this set of arguments. We can use this later to link the results back to this specific set of choices. We also include a short description of the analysis.</p>
<p>We can easily create more analyses, for example by including adjustments for age and seasonality, or for including other drugs in the model:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">covarProphylactics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEraCovariateSettings.html">createEraCovariateSettings</a></span><span class="op">(</span>
  label <span class="op">=</span> <span class="st">"Prophylactics"</span>,
  includeEraIds <span class="op">=</span> <span class="st">"prophylactics"</span>,
  start <span class="op">=</span> <span class="fl">1</span>,
  end <span class="op">=</span> <span class="fl">0</span>,
  endAnchor <span class="op">=</span> <span class="st">"era end"</span><span class="op">)</span>

<span class="va">createSccsIntervalDataArgs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCreateSccsIntervalDataArgs.html">createCreateSccsIntervalDataArgs</a></span><span class="op">(</span>
  eraCovariateSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">covarExposureOfInt</span>,
                             <span class="va">covarProphylactics</span><span class="op">)</span><span class="op">)</span>

<span class="va">sccsAnalysis2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSccsAnalysis.html">createSccsAnalysis</a></span><span class="op">(</span>
  analysisId <span class="op">=</span> <span class="fl">2</span>,
  description <span class="op">=</span> <span class="st">"Including prophylactics"</span>,
  getDbSccsDataArgs <span class="op">=</span> <span class="va">getDbSccsDataArgs1</span>,
  createStudyPopulationArgs <span class="op">=</span> <span class="va">createStudyPopulationArgs1</span>,
  createSccsIntervalDataArgs <span class="op">=</span> <span class="va">createSccsIntervalDataArgs2</span>,
  fitSccsModelArgs <span class="op">=</span> <span class="va">fitSccsModelArgs</span><span class="op">)</span>

<span class="va">ageSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAgeCovariateSettings.html">createAgeCovariateSettings</a></span><span class="op">(</span>ageKnots <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="va">seasonalitySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSeasonalityCovariateSettings.html">createSeasonalityCovariateSettings</a></span><span class="op">(</span>seasonKnots <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="va">covarPreExp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEraCovariateSettings.html">createEraCovariateSettings</a></span><span class="op">(</span>
  label <span class="op">=</span> <span class="st">"Pre-exposure"</span>,
  includeEraIds <span class="op">=</span> <span class="st">"exposureId"</span>,
  start <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>,
  end <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
  endAnchor <span class="op">=</span> <span class="st">"era start"</span><span class="op">)</span>

<span class="va">createSccsIntervalDataArgs3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCreateSccsIntervalDataArgs.html">createCreateSccsIntervalDataArgs</a></span><span class="op">(</span>
  eraCovariateSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">covarExposureOfInt</span>,
                              <span class="va">covarPreExp</span>,
                              <span class="va">covarProphylactics</span><span class="op">)</span>,
  ageCovariateSettings <span class="op">=</span> <span class="va">ageSettings</span>,
  seasonalityCovariateSettings <span class="op">=</span> <span class="va">seasonalitySettings</span>,
  eventDependentObservation <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">sccsAnalysis3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSccsAnalysis.html">createSccsAnalysis</a></span><span class="op">(</span>
  analysisId <span class="op">=</span> <span class="fl">3</span>,
  description <span class="op">=</span> <span class="st">"Including prophylactics, age, season, pre-exposure, and censoring"</span>,
  getDbSccsDataArgs <span class="op">=</span> <span class="va">getDbSccsDataArgs1</span>,
  createStudyPopulationArgs <span class="op">=</span> <span class="va">createStudyPopulationArgs1</span>,
  createSccsIntervalDataArgs <span class="op">=</span> <span class="va">createSccsIntervalDataArgs3</span>,
  fitSccsModelArgs <span class="op">=</span> <span class="va">fitSccsModelArgs</span><span class="op">)</span>

<span class="va">covarAllDrugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEraCovariateSettings.html">createEraCovariateSettings</a></span><span class="op">(</span>
  label <span class="op">=</span> <span class="st">"Other exposures"</span>,
  excludeEraIds <span class="op">=</span> <span class="st">"exposureId"</span>,
  stratifyById <span class="op">=</span> <span class="cn">TRUE</span>,
  start <span class="op">=</span> <span class="fl">1</span>,
  end <span class="op">=</span> <span class="fl">0</span>,
  endAnchor <span class="op">=</span> <span class="st">"era end"</span>,
  allowRegularization <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">createSccsIntervalDataArgs4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCreateSccsIntervalDataArgs.html">createCreateSccsIntervalDataArgs</a></span><span class="op">(</span>
  eraCovariateSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">covarExposureOfInt</span>,
                              <span class="va">covarPreExp</span>,
                              <span class="va">covarAllDrugs</span><span class="op">)</span>,
  ageCovariateSettings <span class="op">=</span> <span class="va">ageSettings</span>,
  seasonalityCovariateSettings <span class="op">=</span> <span class="va">seasonalitySettings</span>,
  eventDependentObservation <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">sccsAnalysis4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSccsAnalysis.html">createSccsAnalysis</a></span><span class="op">(</span>
  analysisId <span class="op">=</span> <span class="fl">4</span>,
  description <span class="op">=</span> <span class="st">"Including all other drugs"</span>,
  getDbSccsDataArgs <span class="op">=</span> <span class="va">getDbSccsDataArgs1</span>,
  createStudyPopulationArgs <span class="op">=</span> <span class="va">createStudyPopulationArgs1</span>,
  createSccsIntervalDataArgs <span class="op">=</span> <span class="va">createSccsIntervalDataArgs4</span>,
  fitSccsModelArgs <span class="op">=</span> <span class="va">fitSccsModelArgs</span><span class="op">)</span></code></pre></div>
<p>These analyses can be combined in a list:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sccsAnalysisList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sccsAnalysis1</span>, <span class="va">sccsAnalysis2</span>, <span class="va">sccsAnalysis3</span>, <span class="va">sccsAnalysis4</span><span class="op">)</span></code></pre></div>
<p>A convenient way to save <code>sccsAnalysisList</code> to file is by using the <code>saveSccsAnalysisList</code> function, and we can load it again using the <code>loadSccsAnalysisList</code> function.</p>
<div id="exposure-and-outcome-selection-strategies" class="section level2">
<h2 class="hasAnchor">
<a href="#exposure-and-outcome-selection-strategies" class="anchor"></a>Exposure and outcome selection strategies</h2>
<p>Often we would like to evaluate different definitions of the exposure and/or outcome. We could include these by created extra exposure-outcome pairs, but that would mean that all defined analyses would be executed against these variations of the definitions, and this may not be what we want. Perhaps we would like to define just a single sensitivity analyses with a different outcome definition, in which case we could argue that the strategy of selecting the outcome becomes part of the analysis.</p>
<p>In such a case, we can define the multiple strategies using a list:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcomeIds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>narrowDefinition <span class="op">=</span> <span class="fl">1</span>,
                  broadDefinition <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">exposureOutcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createExposureOutcome.html">createExposureOutcome</a></span><span class="op">(</span>
  exposureId <span class="op">=</span> <span class="fl">1124300</span>,
  outcomeId <span class="op">=</span> <span class="va">outcomeIds</span><span class="op">)</span></code></pre></div>
<p>When we specify an analysis, we can then refer to one definition or the other:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sccsAnalysisA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSccsAnalysis.html">createSccsAnalysis</a></span><span class="op">(</span>
  analysisId <span class="op">=</span> <span class="fl">1</span>,
  description <span class="op">=</span> <span class="st">"Simplest model, using narrow def."</span>,
  outcomeType <span class="op">=</span> <span class="st">"narrowDefinition"</span>,
  getDbSccsDataArgs <span class="op">=</span> <span class="va">getDbSccsDataArgs1</span>,
  createStudyPopulationArgs <span class="op">=</span> <span class="va">createStudyPopulationArgs1</span>,
  createSccsIntervalDataArgs <span class="op">=</span> <span class="va">createSccsIntervalDataArgs1</span>,
  fitSccsModelArgs <span class="op">=</span> <span class="va">fitSccsModelArgs</span><span class="op">)</span>

<span class="va">sccsAnalysisB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSccsAnalysis.html">createSccsAnalysis</a></span><span class="op">(</span>
  analysisId <span class="op">=</span> <span class="fl">2</span>,
  description <span class="op">=</span> <span class="st">"Simplest model, using broad def."</span>,
  outcomeType <span class="op">=</span> <span class="st">"broadDefinition"</span>,
  getDbSccsDataArgs <span class="op">=</span> <span class="va">getDbSccsDataArgs1</span>,
  createStudyPopulationArgs <span class="op">=</span> <span class="va">createStudyPopulationArgs1</span>,
  createSccsIntervalDataArgs <span class="op">=</span> <span class="va">createSccsIntervalDataArgs1</span>,
  fitSccsModelArgs <span class="op">=</span> <span class="va">fitSccsModelArgs</span><span class="op">)</span>

<span class="va">sccsAnalysisList2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sccsAnalysisA</span>, <span class="va">sccsAnalysisB</span><span class="op">)</span></code></pre></div>
<p>In this example, the first analysis (analysisID = 1) will use cohort definition 1 as outcome, whilst the second analysis analysis (analysisID = 2) will use cohort definition 2 as outcome.</p>
<p>The same mechanism can be used to specify types for the exposureId.</p>
</div>
</div>
<div id="executing-multiple-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#executing-multiple-analyses" class="anchor"></a>Executing multiple analyses</h1>
<p>We can now run the analyses against the hypotheses of interest using the <code>runScsAnalyses()</code>function. This function will run all specified analyses against all hypotheses of interest, meaning that the total number of outcome models is <code>length(sccsAnalysisList) * length(exposureOutcomeList)</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSccsAnalyses.html">runSccsAnalyses</a></span><span class="op">(</span>
  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,
  cdmDatabaseSchema <span class="op">=</span> <span class="va">cdmDatabaseSchema</span>,
  exposureDatabaseSchema <span class="op">=</span> <span class="va">cdmDatabaseSchema</span>,
  exposureTable <span class="op">=</span> <span class="st">"drug_era"</span>,
  outcomeDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,
  outcomeTable <span class="op">=</span> <span class="va">outcomeTable</span>,
  cdmVersion <span class="op">=</span> <span class="va">cdmVersion</span>,
  outputFolder <span class="op">=</span> <span class="va">outputFolder</span>,
  combineDataFetchAcrossOutcomes <span class="op">=</span> <span class="cn">TRUE</span>,
  exposureOutcomeList <span class="op">=</span> <span class="va">exposureOutcomeList</span>,
  sccsAnalysisList <span class="op">=</span> <span class="va">sccsAnalysisList</span>,
  getDbSccsDataThreads <span class="op">=</span> <span class="fl">1</span>,
  createStudyPopulationThreads <span class="op">=</span> <span class="fl">3</span>,
  createSccsIntervalDataThreads <span class="op">=</span> <span class="fl">3</span>,
  fitSccsModelThreads <span class="op">=</span> <span class="fl">4</span>,
  cvThreads <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>In the code above, we provide the arguments for connecting to the database, which schemas and tables to use, as well as the analyses and hypotheses of interest. The <code>outputFolder</code> specifies where the outcome models and intermediate files will be written. We also instruct <code>SelfControlledCaseSeries</code> to use multiple threads for various stages in the analyses, meaning these will be executed in parallel on multiple CPUs in the computer. Multithreading can significantly reduce execution time, but will require more system resources such as memory and temporary disk space.</p>
<div id="restarting" class="section level2">
<h2 class="hasAnchor">
<a href="#restarting" class="anchor"></a>Restarting</h2>
<p>If for some reason the execution was interrupted, you can restart by re-issuing the <code><a href="../reference/runSccsAnalyses.html">runSccsAnalyses()</a></code> command. Any intermediate and final products that have already been completed and written to disk will be skipped.</p>
</div>
</div>
<div id="retrieving-the-results" class="section level1">
<h1 class="hasAnchor">
<a href="#retrieving-the-results" class="anchor"></a>Retrieving the results</h1>
<p>The result of the <code><a href="../reference/runSccsAnalyses.html">runSccsAnalyses()</a></code> is a data frame with one row per exposure-outcome-analysis combination. It provides the file names of the intermediate and end-result files that were constructed. For example, we can retrieve the fitted model for the combination of our drug of interest, outcome, and first analysis:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sccsModelFile</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">sccsModelFile</span><span class="op">[</span><span class="va">result</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">==</span> <span class="fl">1124300</span> <span class="op">&amp;</span> 
                                      <span class="va">result</span><span class="op">$</span><span class="va">outcomeId</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span>
                                      <span class="va">result</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>
<span class="va">sccsModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">outputFolder</span>, <span class="va">sccsModelFile</span><span class="op">)</span><span class="op">)</span>
<span class="va">sccsModel</span></code></pre></div>
<pre><code>## $estimates
##   covariateId     logRr originalCovariateId originalCovariateName
## 1        1000 0.2447448             1124300            Diclofenac
##                      covariateName   logLb95   logUb95    seLogRr
## 1 Exposure of interest: Diclofenac 0.2105088 0.2787271 0.01740293
## 
## $priorVariance
## [1] NA
## 
## $status
## [1] "OK"
## 
## $metaData
## $metaData$getDbCall
## getDbSccsData(connectionDetails = list(dbms = "pdw", server = "JRDUSAPSCTL01", 
##     port = "17001", oracleDriver = "thin"), cdmDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##     oracleTempSchema = "cdm_truven_mdcd_v780.dbo", outcomeDatabaseSchema = "scratch.dbo", 
##     outcomeTable = "mschuemi_sccs_vignette", outcomeIds = 1, 
##     exposureDatabaseSchema = "cdm_truven_mdcd_v780.dbo", exposureTable = "drug_era", 
##     exposureIds = NULL, useCustomCovariates = FALSE, customCovariateDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##     customCovariateTable = "cohort", customCovariateIds = NULL, 
##     useNestingCohort = FALSE, nestingCohortDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##     nestingCohortTable = "cohort", nestingCohortId = -1, deleteCovariatesSmallCount = 100, 
##     studyStartDate = "", studyEndDate = "", cdmVersion = "5", 
##     maxCasesPerOutcome = 0)
## 
## $metaData$eraCall
## createSccsEraData(sccsData = list(cases = list(virtual = list(
##     VirtualVmode = c("double", "double", "double", "double", 
##     "double", "double", "double", "double"), AsIs = c(FALSE, 
##     FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), VirtualIsMatrix = c(FALSE, 
##     FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), PhysicalIsMatrix = c(FALSE, 
##     FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), PhysicalElementNo = c(1L, 
##     2L, 3L, 4L, 5L, 6L, 8L, 7L), PhysicalFirstCol = c(1L, 1L, 
##     1L, 1L, 1L, 1L, 1L, 1L), PhysicalLastCol = c(1L, 1L, 1L, 
##     1L, 1L, 1L, 1L, 1L)), physical = list(list.. = list(), list...1 = list(), 
##     list...2 = list(), list...3 = list(), list...4 = list(), 
##     list...5 = list(), list...7 = list(), ageInDays = list())), 
##     eras = list(virtual = list(VirtualVmode = c("integer", "double", 
##     "double", "double", "double", "double"), AsIs = c(FALSE, 
##     FALSE, FALSE, FALSE, FALSE, FALSE), VirtualIsMatrix = c(FALSE, 
##     FALSE, FALSE, FALSE, FALSE, FALSE), PhysicalIsMatrix = c(FALSE, 
##     FALSE, FALSE, FALSE, FALSE, FALSE), PhysicalElementNo = 1:6, 
##         PhysicalFirstCol = c(1L, 1L, 1L, 1L, 1L, 1L), PhysicalLastCol = c(1L, 
##         1L, 1L, 1L, 1L, 1L)), physical = list(list.. = list(), 
##         list...1 = list(), list...2 = list(), list...3 = list(), 
##         list...4 = list(), list...5 = list())), covariateRef = list(
##         virtual = list(VirtualVmode = c("double", "integer"), 
##             AsIs = c(FALSE, FALSE), VirtualIsMatrix = c(FALSE, 
##             FALSE), PhysicalIsMatrix = c(FALSE, FALSE), PhysicalElementNo = 1:2, 
##             PhysicalFirstCol = c(1L, 1L), PhysicalLastCol = c(1L, 
##             1L)), physical = list(list.. = list(), list...1 = list())), 
##     metaData = list(exposureIds = NULL, outcomeIds = 1, call = getDbSccsData(connectionDetails = list(
##         dbms = "pdw", server = "JRDUSAPSCTL01", port = "17001", 
##         oracleDriver = "thin"), cdmDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##         oracleTempSchema = "cdm_truven_mdcd_v780.dbo", outcomeDatabaseSchema = "scratch.dbo", 
##         outcomeTable = "mschuemi_sccs_vignette", outcomeIds = 1, 
##         exposureDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##         exposureTable = "drug_era", exposureIds = NULL, useCustomCovariates = FALSE, 
##         customCovariateDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##         customCovariateTable = "cohort", customCovariateIds = NULL, 
##         useNestingCohort = FALSE, nestingCohortDatabaseSchema = "cdm_truven_mdcd_v780.dbo", 
##         nestingCohortTable = "cohort", nestingCohortId = -1, 
##         deleteCovariatesSmallCount = 100, studyStartDate = "", 
##         studyEndDate = "", cdmVersion = "5", maxCasesPerOutcome = 0))), 
##     outcomeId = 1, naivePeriod = 180, firstOutcomeOnly = FALSE, 
##     covariateSettings = list(list(includeCovariateIds = 1124300, 
##         label = "Exposure of interest", stratifyById = TRUE, 
##         start = 1, addExposedDaysToStart = FALSE, end = 0, addExposedDaysToEnd = TRUE, 
##         firstOccurrenceOnly = FALSE, allowRegularization = FALSE)), 
##     ageSettings = list(includeAge = FALSE, ageKnots = 5, allowRegularization = FALSE, 
##         computeConfidenceIntervals = FALSE), seasonalitySettings = list(
##         includeSeasonality = FALSE, seasonKnots = 5, allowRegularization = FALSE, 
##         computeConfidenceIntervals = FALSE), minCasesForAgeSeason = 10000, 
##     eventDependentObservation = FALSE)
## 
## $metaData$outcomeId
## [1] 1
## 
## $metaData$covariateSettingsList
## $metaData$covariateSettingsList[[1]]
## $includeCovariateIds
## [1] 1124300
## 
## $label
## [1] "Exposure of interest"
## 
## $stratifyById
## [1] TRUE
## 
## $start
## [1] 1
## 
## $addExposedDaysToStart
## [1] FALSE
## 
## $end
## [1] 0
## 
## $addExposedDaysToEnd
## [1] TRUE
## 
## $firstOccurrenceOnly
## [1] FALSE
## 
## $allowRegularization
## [1] FALSE
## 
## $covariateIds
## [1] 1124300
## 
## $outputIds
##      [,1]
## [1,] 1000
## 
## attr(,"class")
## [1] "covariateSettings"
## 
## 
## $metaData$counts
##   outcomeConceptId eventCount caseCount
## 1                1      60118     26323
## 
## 
## attr(,"class")
## [1] "sccsModel"</code></pre>
<p>Note that some of the file names will appear several times in the table. For example, all analysis share the same sccsData object.</p>
<p>We can create a summary of the results using <code><a href="../reference/summarizeSccsAnalyses.html">summarizeSccsAnalyses()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">analysisSum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarizeSccsAnalyses.html">summarizeSccsAnalyses</a></span><span class="op">(</span><span class="va">result</span>, <span class="va">outputFolder</span><span class="op">)</span>
<span class="va">analysisSum</span></code></pre></div>
<pre><code>##     analysisId exposureId outcomeId caseCount eventCount
## 1            1    1124300         1     26323      60118
## 2            1     705178         1      1116       2743
## 3            1     705944         1      5420       9244
## 4            1     710650         1       681       1454
## 5            1     714785         1      6509      11199
## 6            1     719174         1      8855      22823
## 7            1     719311         1      6675      11474
## 8            1     735340         1       204        397
## 9            1     742185         1      1988       3244
## 10           1     780369         1      5885      15717
## 11           1     781182         1      1572       4430
## 12           1     924724         1     34211      91890
## 13           1     990760         1      4149      15651
## 14           1    1110942         1       260        546
## 15           1    1111706         1       312        692
## 16           1    1136601         1     28650      66462
## 17           1    1317967         1       617       1716
## 18           1    1501309         1       413        870
## 19           1    1505346         1       489       1135
## 20           1    1551673         1       164        299
## 21           1    1560278         1      7411      24338
## 22           1    1584910         1       183        371
## 23           1   19010309         1      4327      14166
## 24           1   19044727         1      6339      22163
## 25           1   40163731         1      1813       5985
## 26           2    1124300         1    145668     397941
## 27           2     705178         1    138272     385724
## 28           2     705944         1    140920     388921
## 29           2     710650         1    138112     385446
## 30           2     714785         1    141358     389560
## 31           2     719174         1    141137     390768
## 32           2     719311         1    141430     389658
## 33           2     735340         1    137980     385190
## 34           2     742185         1    138892     386349
## 35           2     780369         1    139534     388098
## 36           2     781182         1    138295     385811
## 37           2     924724         1    147535     402598
## 38           2     990760         1    138597     386774
## 39           2    1110942         1    137994     385269
## 40           2    1111706         1    137984     385215
## 41           2    1136601         1    147727     401863
## 42           2    1317967         1    138082     385474
## 43           2    1501309         1    138047     385329
## 44           2    1505346         1    138037     385321
## 45           2    1551673         1    137974     385187
## 46           2    1560278         1    140380     390891
## 47           2    1584910         1    137984     385208
## 48           2   19010309         1    138953     387267
## 49           2   19044727         1    140493     391350
## 50           2   40163731         1    138969     388001
## 51           3    1124300         1    150305     414104
## 52           3     705178         1    143073     402400
## 53           3     705944         1    145683     405534
## 54           3     710650         1    142916     402137
## 55           3     714785         1    146111     406158
## 56           3     719174         1    145878     407172
## 57           3     719311         1    146181     406254
## 58           3     735340         1    142790     401889
## 59           3     742185         1    143683     403015
## 60           3     780369         1    144295     404639
## 61           3     781182         1    143098     402489
## 62           3     924724         1    152127     418379
## 63           3     990760         1    143387     403380
## 64           3    1110942         1    142803     401963
## 65           3    1111706         1    142791     401904
## 66           3    1136601         1    152330     417795
## 67           3    1317967         1    142883     402128
## 68           3    1501309         1    142855     402022
## 69           3    1505346         1    142843     401999
## 70           3    1551673         1    142783     401883
## 71           3    1560278         1    145126     407267
## 72           3    1584910         1    142792     401899
## 73           3   19010309         1    143736     403837
## 74           3   19044727         1    145218     407665
## 75           3   40163731         1    143732     404469
## 76           4    1124300         1    341275     760054
## 77           4     705178         1    341275     760054
## 78           4     705944         1    341275     760054
## 79           4     710650         1    341275     760054
## 80           4     714785         1    341275     760054
## 81           4     719174         1    341275     760054
## 82           4     719311         1    341275     760054
## 83           4     735340         1    341275     760054
## 84           4     742185         1    341275     760054
## 85           4     780369         1    341275     760054
## 86           4     781182         1    341275     760054
## 87           4     924724         1    341275     760054
## 88           4     990760         1    341275     760054
## 89           4    1110942         1    341275     760054
## 90           4    1111706         1    341275     760054
## 91           4    1136601         1    341275     760054
## 92           4    1317967         1    341275     760054
## 93           4    1501309         1    341275     760054
## 94           4    1505346         1    341275     760054
## 95           4    1551673         1    341275     760054
## 96           4    1560278         1    341276     760055
## 97           4    1584910         1    341275     760054
## 98           4   19010309         1    341275     760054
## 99           4   19044727         1    341275     760054
## 100          4   40163731         1    341275     760054
##     rr(Exposure of interest) ci95lb(Exposure of interest)
## 1                  1.2772953                    1.2343060
## 2                  1.0715129                    0.9495034
## 3                  0.9511726                    0.8907972
## 4                  0.9329491                    0.7873739
## 5                  1.0374991                    0.9839866
## 6                  1.0544470                    1.0116936
## 7                  1.0394431                    0.9867870
## 8                  1.5832133                    1.0005218
## 9                  1.0793969                    0.9618290
## 10                 1.0982351                    1.0172691
## 11                 1.0114162                    0.8866900
## 12                 1.4413837                    1.3985408
## 13                 1.0358504                    0.9850001
## 14                 0.9463070                    0.7397601
## 15                 0.6951726                    0.5503998
## 16                 1.1836178                    1.1254284
## 17                 0.8456913                    0.7122428
## 18                 1.0504796                    0.8587757
## 19                 1.2003501                    0.9957619
## 20                 0.9261016                    0.6360498
## 21                 1.3761063                    1.2317669
## 22                 1.1708279                    0.8794884
## 23                 1.3708866                    1.2535818
## 24                 1.7430872                    1.6190233
## 25                 1.2021389                    0.9107372
## 26                 1.2825714                    1.2394589
## 27                 1.0786484                    0.9561201
## 28                 0.9524536                    0.8919987
## 29                 0.9392255                    0.7927199
## 30                 1.0394087                    0.9859661
## 31                 1.0571733                    1.0144012
## 32                 1.0414924                    0.9887049
## 33                 1.5879043                    1.0034823
## 34                 1.0802147                    0.9625912
## 35                 1.1045431                    1.0231582
## 36                 1.0211926                    0.8953617
## 37                 1.4438676                    1.4008784
## 38                 1.0371263                    0.9863509
## 39                 0.9482377                    0.7412329
## 40                 0.7001463                    0.5541300
## 41                 1.1849023                    1.1266345
## 42                 0.8634126                    0.7270507
## 43                 1.0519035                    0.8595627
## 44                 1.2084803                    1.0020594
## 45                 0.9268760                    0.6368262
## 46                 1.3734962                    1.2294567
## 47                 1.1747664                    0.8824601
## 48                 1.3732652                    1.2557649
## 49                 1.7447539                    1.6205874
## 50                 1.2012890                    0.9100118
## 51                 1.2683158                    1.2252255
## 52                 1.0979683                    0.9707577
## 53                 0.9517039                    0.8901631
## 54                 0.9358771                    0.7866183
## 55                 1.0197131                    0.9658041
## 56                 1.0832663                    1.0385708
## 57                 1.0236213                    0.9701457
## 58                 1.6127092                    1.0170668
## 59                 1.1327970                    1.0074721
## 60                 1.1879325                    1.0993988
## 61                 1.0579122                    0.9256616
## 62                 1.6725951                    1.6228917
## 63                 1.1249153                    1.0687202
## 64                 0.9421134                    0.7297001
## 65                 0.7684474                    0.6011376
## 66                 1.1617408                    1.1043584
## 67                 0.8855488                    0.7427874
## 68                 1.1623651                    0.9437479
## 69                 1.3081097                    1.0828074
## 70                 1.0363085                    0.7061763
## 71                 1.4390767                    1.2881036
## 72                 1.1048329                    0.8234708
## 73                 1.5692527                    1.4357319
## 74                 1.9086519                    1.7733703
## 75                 1.1852314                    0.8985213
## 76                 1.2221195                    1.1800664
## 77                 1.0875097                    0.9601554
## 78                 0.9119569                    0.8526855
## 79                 0.8565128                    0.7186404
## 80                 0.9935277                    0.8161080
## 81                 1.0929802                    1.0469574
## 82                 0.9975330                    0.8879061
## 83                 1.6266594                    1.0253757
## 84                 1.1391208                    1.0126912
## 85                 1.1007664                    1.0185614
## 86                 1.0651316                    0.9320154
## 87                 1.3441351                    1.3042516
## 88                 0.9827672                    0.8315336
## 89                 0.9494567                    0.7348169
## 90                 0.7357112                    0.5745769
## 91                 1.0452966                    0.9934594
## 92                 0.8304900                    0.6960359
## 93                 1.0773900                    0.8737673
## 94                 1.2251340                    1.0111967
## 95                 1.0306868                    0.7000110
## 96                 1.2515384                    1.1202678
## 97                 1.0675196                    0.7976441
## 98                 0.9957156                    0.9077572
## 99                 1.6189413                    1.4974135
## 100                1.0418907                    0.7893019
##     ci95ub(Exposure of interest) logRr(Exposure of interest)
## 1                      1.3214466                 0.244744778
## 2                      1.2073372                 0.069071597
## 3                      1.0150858                -0.050059780
## 4                      1.1006969                -0.069404601
## 5                      1.0936205                 0.036813064
## 6                      1.0988127                 0.053016465
## 7                      1.0946561                 0.038685041
## 8                      2.3894555                 0.459456544
## 9                      1.2096046                 0.076402460
## 10                     1.1843117                 0.093704441
## 11                     1.1496661                 0.011351537
## 12                     1.4853029                 0.365603530
## 13                     1.0888983                 0.035222712
## 14                     1.2018446                -0.055188234
## 15                     0.8749834                -0.363595188
## 16                     1.2440891                 0.168575677
## 17                     0.9986322                -0.167600892
## 18                     1.2796687                 0.049246781
## 19                     1.4407196                 0.182613267
## 20                     1.3238566                -0.076771283
## 21                     1.5329890                 0.319257966
## 22                     1.5497881                 0.157711085
## 23                     1.4970651                 0.315457668
## 24                     1.8751710                 0.555657786
## 25                     1.5546445                 0.184102380
## 26                     1.3268454                 0.248866973
## 27                     1.2153283                 0.075708782
## 28                     1.0164491                -0.048713873
## 29                     1.1084660                -0.062699632
## 30                     1.0954847                 0.038651982
## 31                     1.1015449                 0.055598674
## 32                     1.0968479                 0.040654641
## 33                     2.3965442                 0.462415073
## 34                     1.2104521                 0.077159817
## 35                     1.1909935                 0.099431771
## 36                     1.1604972                 0.020971121
## 37                     1.4879425                 0.367325372
## 38                     1.0901479                 0.036453711
## 39                     1.2043086                -0.053150081
## 40                     0.8815074                -0.356465977
## 41                     1.2454591                 0.169660329
## 42                     1.0199195                -0.146862618
## 43                     1.2813014                 0.050601407
## 44                     1.4510862                 0.189363580
## 45                     1.3245044                -0.075935516
## 46                     1.5300479                 0.317359457
## 47                     1.5549726                 0.161069302
## 48                     1.4996261                 0.317191288
## 49                     1.8769536                 0.556613531
## 50                     1.5535993                 0.183395173
## 51                     1.3126371                 0.237689910
## 52                     1.2399309                 0.093461465
## 53                     1.0169374                -0.049501307
## 54                     1.1090299                -0.066271096
## 55                     1.0763664                 0.019521327
## 56                     1.1296941                 0.079980832
## 57                     1.0798066                 0.023346619
## 58                     2.4395831                 0.477915523
## 59                     1.2713128                 0.124689753
## 60                     1.2820846                 0.172214436
## 61                     1.2043613                 0.056297347
## 62                     1.7235508                 0.514376375
## 63                     1.1836597                 0.117707781
## 64                     1.2077862                -0.059629671
## 65                     0.9784294                -0.263383108
## 66                     1.2213723                 0.149919569
## 67                     1.0500201                -0.121547722
## 68                     1.4247767                 0.150456779
## 69                     1.5734969                 0.268583089
## 70                     1.4907468                 0.035664842
## 71                     1.6033725                 0.364001710
## 72                     1.4737811                 0.099694070
## 73                     1.7123985                 0.450599550
## 74                     2.0525897                 0.646397158
## 75                     1.5318087                 0.169938062
## 76                     1.2653273                 0.200586607
## 77                     1.2296552                 0.083890404
## 78                     0.9747433                -0.092162530
## 79                     1.0167325                -0.154885962
## 80                     1.1190519                -0.006493337
## 81                     1.1414216                 0.088908136
## 82                     1.2122177                -0.002470083
## 83                     2.4627066                 0.486528446
## 84                     1.2788900                 0.130256769
## 85                     1.1886426                 0.096006644
## 86                     1.2128731                 0.063098340
## 87                     1.3850074                 0.295750768
## 88                     1.1614982                -0.017382980
## 89                     1.2180478                -0.051865395
## 90                     0.9382852                -0.306917634
## 91                     1.0990155                 0.044300647
## 92                     0.9854990                -0.185739420
## 93                     1.3220706                 0.074541486
## 94                     1.4776984                 0.203050202
## 95                     1.4872082                 0.030225356
## 96                     1.3941689                 0.224373549
## 97                     1.4204504                 0.065337804
## 98                     1.0902481                -0.004293648
## 99                     1.7492892                 0.481772417
## 100                    1.3475384                 0.041037081
##     seLogRr(Exposure of interest) rr(Pre-exposure) ci95lb(Pre-exposure)
## 1                      0.01740293               NA                   NA
## 2                      0.06128518               NA                   NA
## 3                      0.03331990               NA                   NA
## 4                      0.08545961               NA                   NA
## 5                      0.02694863               NA                   NA
## 6                      0.02107298               NA                   NA
## 7                      0.02646512               NA                   NA
## 8                      0.22208160               NA                   NA
## 9                      0.05847356               NA                   NA
## 10                     0.03878645               NA                   NA
## 11                     0.06625921               NA                   NA
## 12                     0.01535471               NA                   NA
## 13                     0.02558208               NA                   NA
## 14                     0.12379995               NA                   NA
## 15                     0.11825728               NA                   NA
## 16                     0.02557187               NA                   NA
## 17                     0.08621782               NA                   NA
## 18                     0.10174900               NA                   NA
## 19                     0.09423383               NA                   NA
## 20                     0.18700026               NA                   NA
## 21                     0.05580964               NA                   NA
## 22                     0.14452641               NA                   NA
## 23                     0.04528188               NA                   NA
## 24                     0.03746926               NA                   NA
## 25                     0.13641777               NA                   NA
## 26                     0.01738025               NA                   NA
## 27                     0.06119654               NA                   NA
## 28                     0.03331845               NA                   NA
## 29                     0.08552771               NA                   NA
## 30                     0.02687046               NA                   NA
## 31                     0.02102465               NA                   NA
## 32                     0.02648007               NA                   NA
## 33                     0.22208357               NA                   NA
## 34                     0.05845015               NA                   NA
## 35                     0.03874911               NA                   NA
## 36                     0.06616857               NA                   NA
## 37                     0.01538163               NA                   NA
## 38                     0.02552508               NA                   NA
## 39                     0.12381502               NA                   NA
## 40                     0.11842925               NA                   NA
## 41                     0.02557938               NA                   NA
## 42                     0.08634921               NA                   NA
## 43                     0.10184060               NA                   NA
## 44                     0.09445457               NA                   NA
## 45                     0.18681385               NA                   NA
## 46                     0.05579864               NA                   NA
## 47                     0.14451788               NA                   NA
## 48                     0.04527404               NA                   NA
## 49                     0.03746532               NA                   NA
## 50                     0.13644947               NA                   NA
## 51                     0.01758024        0.9125902            0.8697609
## 52                     0.06243329        1.0458372            0.8124973
## 53                     0.03396646        1.0498947            0.9391971
## 54                     0.08762861        0.8876340            0.6467425
## 55                     0.02764980        1.0044396            0.9087633
## 56                     0.02145482        1.3623795            1.2767197
## 57                     0.02731962        1.0091355            0.9144697
## 58                     0.22319399        0.5559135            0.1974481
## 59                     0.05933930        1.2004893            0.9823284
## 60                     0.03921599        1.1883639            1.0731272
## 61                     0.06714306        0.9781251            0.7873476
## 62                     0.01535156        2.7981497            2.7356712
## 63                     0.02605894        1.9248447            1.8204002
## 64                     0.12855103        1.3883073            1.0129965
## 65                     0.12426878        0.7588456            0.4660039
## 66                     0.02569195        1.1189172            1.0735407
## 67                     0.08830639        1.4274409            1.0843536
## 68                     0.10508134        1.1986212            0.8348079
## 69                     0.09534445        1.7136872            1.2873320
## 70                     0.19060747        0.5324116            0.1879588
## 71                     0.05585261        1.9753113            1.8767752
## 72                     0.14848705        1.0323843            0.6070152
## 73                     0.04495497        2.9897239            2.8153689
## 74                     0.03730181        2.1496069            2.0382722
## 75                     0.13608771        1.6155865            1.4428827
## 76                     0.01779628        0.8837452            0.8421637
## 77                     0.06311186        1.0467437            0.8127254
## 78                     0.03412904        1.0190514            0.9110984
## 79                     0.08851904        0.8247466            0.5997330
## 80                     0.08053473        0.9819486            0.8881785
## 81                     0.02203772        1.3412371            1.2571933
## 82                     0.07942512        0.9865267            0.8935929
## 83                     0.22352500        0.5577705            0.1980913
## 84                     0.05953712        1.1973640            0.9791485
## 85                     0.03939377        1.1410824            1.0302983
## 86                     0.06719457        1.0050228            0.8088940
## 87                     0.01532581        2.3688188            2.3156734
## 88                     0.08525522        1.7477203            1.6523703
## 89                     0.12892669        1.3531457            0.9866309
## 90                     0.12510945        0.7539810            0.4625676
## 91                     0.02575987        1.0769522            1.0329534
## 92                     0.08871256        1.3912373            1.0568246
## 93                     0.10564997        1.1906631            0.8286257
## 94                     0.09677505        1.5983161            1.1988211
## 95                     0.19223820        0.5678770            0.2005273
## 96                     0.05579967        1.8008948            1.7107641
## 97                     0.14721363        0.9103618            0.5354889
## 98                     0.04673136        2.5552900            2.4056996
## 99                     0.03966150        1.9209477            1.8209620
## 100                    0.13645301        1.5513583            1.3850669
##     ci95ub(Pre-exposure) logRr(Pre-exposure) seLogRr(Pre-exposure)
## 1                     NA                  NA                    NA
## 2                     NA                  NA                    NA
## 3                     NA                  NA                    NA
## 4                     NA                  NA                    NA
## 5                     NA                  NA                    NA
## 6                     NA                  NA                    NA
## 7                     NA                  NA                    NA
## 8                     NA                  NA                    NA
## 9                     NA                  NA                    NA
## 10                    NA                  NA                    NA
## 11                    NA                  NA                    NA
## 12                    NA                  NA                    NA
## 13                    NA                  NA                    NA
## 14                    NA                  NA                    NA
## 15                    NA                  NA                    NA
## 16                    NA                  NA                    NA
## 17                    NA                  NA                    NA
## 18                    NA                  NA                    NA
## 19                    NA                  NA                    NA
## 20                    NA                  NA                    NA
## 21                    NA                  NA                    NA
## 22                    NA                  NA                    NA
## 23                    NA                  NA                    NA
## 24                    NA                  NA                    NA
## 25                    NA                  NA                    NA
## 26                    NA                  NA                    NA
## 27                    NA                  NA                    NA
## 28                    NA                  NA                    NA
## 29                    NA                  NA                    NA
## 30                    NA                  NA                    NA
## 31                    NA                  NA                    NA
## 32                    NA                  NA                    NA
## 33                    NA                  NA                    NA
## 34                    NA                  NA                    NA
## 35                    NA                  NA                    NA
## 36                    NA                  NA                    NA
## 37                    NA                  NA                    NA
## 38                    NA                  NA                    NA
## 39                    NA                  NA                    NA
## 40                    NA                  NA                    NA
## 41                    NA                  NA                    NA
## 42                    NA                  NA                    NA
## 43                    NA                  NA                    NA
## 44                    NA                  NA                    NA
## 45                    NA                  NA                    NA
## 46                    NA                  NA                    NA
## 47                    NA                  NA                    NA
## 48                    NA                  NA                    NA
## 49                    NA                  NA                    NA
## 50                    NA                  NA                    NA
## 51             0.9568900        -0.091468308            0.02435507
## 52             1.3236006         0.044817705            0.12449170
## 53             1.1700706         0.048689866            0.05607093
## 54             1.1875247        -0.119195831            0.15502279
## 55             1.1074420         0.004429778            0.05044059
## 56             1.4521386         0.309232805            0.03284329
## 57             1.1109552         0.009094005            0.04965171
## 58             1.2147393        -0.587142616            0.46348024
## 59             1.4515427         0.182729236            0.09960810
## 60             1.3116354         0.172577448            0.05119936
## 61             1.1988596        -0.022117720            0.10726121
## 62             2.8603989         1.028958379            0.01137374
## 63             2.0340355         0.654845287            0.02830801
## 64             1.8695945         0.328085236            0.15633165
## 65             1.1708790        -0.275956889            0.23503390
## 66             1.1655913         0.112361468            0.02098669
## 67             1.8426185         0.355883227            0.13525849
## 68             1.6691759         0.181171855            0.17675929
## 69             2.2382781         0.538647291            0.14110846
## 70             1.1757039        -0.630338314            0.46771260
## 71             2.0778004         0.680725999            0.02595834
## 72             1.6503959         0.031870957            0.25516202
## 73             3.1722061         1.095181046            0.03044290
## 74             2.2654925         0.765285007            0.02696215
## 75             1.8039009         0.479698071            0.05696750
## 76             0.9267481        -0.123586507            0.02441560
## 77             1.3256849         0.045684131            0.12482147
## 78             1.1359158         0.018872190            0.05626215
## 79             1.1059773        -0.192679061            0.15612535
## 80             1.0828812        -0.018216312            0.05056414
## 81             1.4300476         0.293592406            0.03286439
## 82             1.0863542        -0.013564935            0.04983059
## 83             1.2190287        -0.583807753            0.46354970
## 84             1.4487722         0.180122479            0.09994785
## 85             1.2598637         0.131977326            0.05131605
## 86             1.2325107         0.005010211            0.10743583
## 87             2.4229513         0.862391424            0.01155271
## 88             1.8465603         0.558312249            0.02834589
## 89             1.8244061         0.302432046            0.15681761
## 90             1.1648985        -0.282388123            0.23561572
## 91             1.1222358         0.074135060            0.02114856
## 92             1.7953929         0.330193527            0.13519511
## 93             1.6592574         0.174510355            0.17713510
## 94             2.0898808         0.468950618            0.14178025
## 95             1.2538764        -0.565850381            0.46762202
## 96             1.8945592         0.588283678            0.02603264
## 97             1.4551801        -0.093913179            0.25503142
## 98             2.7120020         0.938165709            0.03057361
## 99             2.0250930         0.652818672            0.02710527
## 100            1.7319930         0.439130863            0.05702256</code></pre>
<p>This tells us, per exposure-outcome-analysis combination, the estimated relative risk and 95% confidence interval, as well as the number of subjects (cases) and the number of events observed for those subjects.</p>
<div id="empirical-calibration" class="section level2">
<h2 class="hasAnchor">
<a href="#empirical-calibration" class="anchor"></a>Empirical calibration</h2>
<p>Now that we have produced estimates for all outcomes including our negative controls, we can perform empirical calibration to estimate the bias of the various analyses included in our study. We will create the calibration effect plots for every analysis ID. In each plot, the blue dots represent our negative control exposures, and the yellow diamond represents our exposure of interest: diclofenac. An unbiased, well-calibrated analysis should have 95% of the negative controls between the dashed lines (ie. 95% should have p &gt; .05).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"EmpiricalCalibration"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/EmpiricalCalibration/">EmpiricalCalibration</a></span><span class="op">)</span>

<span class="co"># Analysis 1: Simplest model</span>
<span class="va">negCons</span> <span class="op">&lt;-</span> <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">!=</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">ei</span> <span class="op">&lt;-</span>  <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">==</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/fitNull.html">fitNull</a></span><span class="op">(</span><span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/plotCalibrationEffect.html">plotCalibrationEffect</a></span><span class="op">(</span>logRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      logRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      <span class="va">null</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleAnalyses_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Analysis 2: Including prophylactics</span>
<span class="va">negCons</span> <span class="op">&lt;-</span> <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">!=</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">ei</span> <span class="op">&lt;-</span>  <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">==</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/fitNull.html">fitNull</a></span><span class="op">(</span><span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/plotCalibrationEffect.html">plotCalibrationEffect</a></span><span class="op">(</span>logRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      logRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      <span class="va">null</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleAnalyses_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Analysis 3: Including prophylactics, age, season, pre-exposure, and censoring</span>
<span class="va">negCons</span> <span class="op">&lt;-</span> <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">!=</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">ei</span> <span class="op">&lt;-</span>  <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">==</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/fitNull.html">fitNull</a></span><span class="op">(</span><span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/plotCalibrationEffect.html">plotCalibrationEffect</a></span><span class="op">(</span>logRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      logRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      <span class="va">null</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleAnalyses_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Analysis 4: Including all other drugs (as well as prophylactics, age, season, pre-</span>
<span class="co"># exposure, and censoring)</span>
<span class="va">negCons</span> <span class="op">&lt;-</span> <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">!=</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">ei</span> <span class="op">&lt;-</span>  <span class="va">analysisSum</span><span class="op">[</span><span class="va">analysisSum</span><span class="op">$</span><span class="va">analysisId</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">analysisSum</span><span class="op">$</span><span class="va">exposureId</span> <span class="op">==</span> <span class="fl">1124300</span>, <span class="op">]</span>
<span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/fitNull.html">fitNull</a></span><span class="op">(</span><span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/EmpiricalCalibration/man/plotCalibrationEffect.html">plotCalibrationEffect</a></span><span class="op">(</span>logRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrNegatives <span class="op">=</span> <span class="va">negCons</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      logRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`logRr(Exposure of interest)`</span>, 
                      seLogRrPositives <span class="op">=</span> <span class="va">ei</span><span class="op">$</span><span class="va">`seLogRr(Exposure of interest)`</span>, 
                      <span class="va">null</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleAnalyses_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
</div>
<div id="acknowledgments" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h1>
<p>Considerable work has been dedicated to provide the <code>SelfControlledCaseSeries</code> package.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="st">"SelfControlledCaseSeries"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## To cite package 'SelfControlledCaseSeries' in publications use:
## 
##   Martijn Schuemie, Patrick Ryan, Trevor Shaddox and Marc Suchard
##   (2021). SelfControlledCaseSeries: Self-Controlled Case Series. R
##   package version 3.1.0.
##   https://github.com/OHDSI/SelfControlledCaseSeries
## 
## A BibTeX entry for LaTeX users is
## 
##   @Manual{,
##     title = {SelfControlledCaseSeries: Self-Controlled Case Series},
##     author = {Martijn Schuemie and Patrick Ryan and Trevor Shaddox and Marc Suchard},
##     year = {2021},
##     note = {R package version 3.1.0},
##     url = {https://github.com/OHDSI/SelfControlledCaseSeries},
##   }</code></pre>
<p>Further, <code>SelfControlledCaseSeries</code> makes extensive use of the <code>Cyclops</code> package.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="st">"Cyclops"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## To cite Cyclops in publications use:
## 
## Suchard MA, Simpson SE, Zorych I, Ryan P, Madigan D (2013). "Massive
## parallelization of serial inference algorithms for complex generalized
## linear models." _ACM Transactions on Modeling and Computer Simulation_,
## *23*, 10. &lt;URL: https://dl.acm.org/doi/10.1145/2414416.2414791&gt;.
## 
## A BibTeX entry for LaTeX users is
## 
##   @Article{,
##     author = {M. A. Suchard and S. E. Simpson and I. Zorych and P. Ryan and D. Madigan},
##     title = {Massive parallelization of serial inference algorithms for complex generalized linear models},
##     journal = {ACM Transactions on Modeling and Computer Simulation},
##     volume = {23},
##     pages = {10},
##     year = {2013},
##     url = {https://dl.acm.org/doi/10.1145/2414416.2414791},
##   }</code></pre>
<p>This work is supported in part through the National Science Foundation grant IIS 1251151.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Martijn Schuemie, Patrick Ryan, Trevor Shaddox, Marc Suchard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
